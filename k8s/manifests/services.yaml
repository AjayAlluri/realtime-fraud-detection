apiVersion: v1
kind: Service
metadata:
  name: zookeeper-service
  namespace: fraud-detection
  labels:
    app: zookeeper
    component: infrastructure
spec:
  type: ClusterIP
  ports:
  - port: 2181
    targetPort: 2181
    name: client
  - port: 2888
    targetPort: 2888
    name: follower
  - port: 3888
    targetPort: 3888
    name: election
  selector:
    app: zookeeper
---
apiVersion: v1
kind: Service
metadata:
  name: kafka-service
  namespace: fraud-detection
  labels:
    app: kafka
    component: infrastructure
spec:
  type: ClusterIP
  clusterIP: None  # Headless service for StatefulSet
  ports:
  - port: 9092
    targetPort: 9092
    name: kafka
  - port: 9093
    targetPort: 9093
    name: kafka-internal
  selector:
    app: kafka
---
apiVersion: v1
kind: Service
metadata:
  name: kafka-external-service
  namespace: fraud-detection
  labels:
    app: kafka
    component: infrastructure
spec:
  type: LoadBalancer
  ports:
  - port: 9092
    targetPort: 9092
    name: kafka
    nodePort: 30092
  selector:
    app: kafka
---
apiVersion: v1
kind: Service
metadata:
  name: redis-master-service
  namespace: fraud-detection
  labels:
    app: redis
    role: master
    component: cache
spec:
  type: ClusterIP
  ports:
  - port: 6379
    targetPort: 6379
    name: redis
  selector:
    app: redis
    role: master
---
apiVersion: v1
kind: Service
metadata:
  name: redis-replica-service
  namespace: fraud-detection
  labels:
    app: redis
    role: replica
    component: cache
spec:
  type: ClusterIP
  ports:
  - port: 6379
    targetPort: 6379
    name: redis
  selector:
    app: redis
    role: replica
---
apiVersion: v1
kind: Service
metadata:
  name: flink-jobmanager-service
  namespace: fraud-detection
  labels:
    app: flink
    component: jobmanager
spec:
  type: ClusterIP
  ports:
  - port: 6123
    targetPort: 6123
    name: rpc
  - port: 6124
    targetPort: 6124
    name: blob-server
  - port: 8081
    targetPort: 8081
    name: webui
  selector:
    app: flink
    component: jobmanager
---
apiVersion: v1
kind: Service
metadata:
  name: flink-jobmanager-webui
  namespace: fraud-detection
  labels:
    app: flink
    component: jobmanager
spec:
  type: LoadBalancer
  ports:
  - port: 8081
    targetPort: 8081
    name: webui
    nodePort: 30081
  selector:
    app: flink
    component: jobmanager
---
apiVersion: v1
kind: Service
metadata:
  name: flink-taskmanager-service
  namespace: fraud-detection
  labels:
    app: flink
    component: taskmanager
spec:
  type: ClusterIP
  clusterIP: None  # Headless service for TaskManagers
  ports:
  - port: 6122
    targetPort: 6122
    name: rpc
  - port: 6125
    targetPort: 6125
    name: query-state
  - port: 9249
    targetPort: 9249
    name: metrics
  selector:
    app: flink
    component: taskmanager
---
apiVersion: v1
kind: Service
metadata:
  name: ml-models-service
  namespace: fraud-detection
  labels:
    app: ml-models-service
    component: ml-inference
spec:
  type: ClusterIP
  ports:
  - port: 8000
    targetPort: 8000
    name: http
  - port: 9090
    targetPort: 9090
    name: metrics
  selector:
    app: ml-models-service
---
apiVersion: v1
kind: Service
metadata:
  name: ml-models-external-service
  namespace: fraud-detection
  labels:
    app: ml-models-service
    component: ml-inference
spec:
  type: LoadBalancer
  ports:
  - port: 8000
    targetPort: 8000
    name: http
    nodePort: 30800
  selector:
    app: ml-models-service
---
apiVersion: v1
kind: Service
metadata:
  name: tensorflow-serving-service
  namespace: fraud-detection
  labels:
    app: tensorflow-serving
    component: ml-inference
spec:
  type: ClusterIP
  ports:
  - port: 8501
    targetPort: 8501
    name: rest-api
  - port: 8500
    targetPort: 8500
    name: grpc
  selector:
    app: tensorflow-serving
---
apiVersion: v1
kind: Service
metadata:
  name: tensorflow-serving-external
  namespace: fraud-detection
  labels:
    app: tensorflow-serving
    component: ml-inference
spec:
  type: LoadBalancer
  ports:
  - port: 8501
    targetPort: 8501
    name: rest-api
    nodePort: 30851
  - port: 8500
    targetPort: 8500
    name: grpc
    nodePort: 30850
  selector:
    app: tensorflow-serving